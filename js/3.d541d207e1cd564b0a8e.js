webpackJsonp([3],{CY7E:function(e,t){},Y2Ra:function(e,t){},eK4w:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={components:{vFile:n("xWEe").a},data:function(){return{pageNum:1}},computed:{userId:function(){return 1*this.$route.params.userId},fileId:function(){if(void 0==this.$route.params.fileId)return"-11";var e=this.$route.params.fileId;return e}}},r={render:function(){var e=this.$createElement;return(this._self._c||e)("v-file",{key:this.fileId,staticClass:"pk",attrs:{fId:this.userId,pageNum:this.pageNum,fileId:this.fileId}})},staticRenderFns:[]};var a=n("VU/8")(i,r,!1,function(e){n("CY7E")},"data-v-b603301a",null);t.default=a.exports},xWEe:function(e,t,n){"use strict";var i=n("Xxa5"),r=n.n(i),a=n("exGp"),o=n.n(a),s=n("o8EA"),l={data:function(){return{title:null,file_id:null,thumbnail:null,centerDialogVisible:!1,tableData:[],height:window.innerHeight-180}},components:{vPlay:n("kzMD").a},filters:{parseTime:function(e){return Object(s.a)(new Date(e))},initSize:function(e){var t=e/1024;return(t=t.toFixed(2))>1024?(t=(t/=1024).toFixed(2))>1024?(t=(t/=1024).toFixed(2))>1024?(t=(t/=1024).toFixed(2),t+="TB"):t+="GB":t+="MB":t+="KB",t}},computed:{user_id:function(){return this.$route.params.user_id},parent_file_id:function(){return this.$route.params.parent_file_id}},watch:{$route:function(e,t){this.init()}},mounted:function(){this.init()},methods:{init:function(){var e=this;return o()(r.a.mark(function t(){var n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/file/list",{params:{user_id:e.user_id,parent_file_id:e.parent_file_id}});case 2:n=t.sent,e.tableData=n,console.log(n);case 5:case"end":return t.stop()}},t,e)}))()},getAllLink:function(e){var t=this;return o()(r.a.mark(function n(){var i,a,o,s;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.$http.get("/file/list",{params:{user_id:t.user_id,parent_file_id:e}});case 2:for(o in i=n.sent,a="",i)"file"==(s=i[o]).type&&(a+=s.name,a+="$",a+=window.location.protocol+"//"+window.location.host+"/file/"+t.user_id+"/"+s.file_id+"/"+encodeURIComponent(s.name.replace("."+s.file_extension,""))+"."+s.file_extension,a+="\n");return n.prev=5,n.next=8,t.$copyText(a);case 8:t.$message({message:"链接已成功复制到剪贴板",type:"success"}),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(5),t.$message.error("复制失败");case 14:case"end":return n.stop()}},n,t,[[5,11]])}))()},getOneLink:function(e,t,n){var i=this;return o()(r.a.mark(function a(){var o;return r.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return o=window.location.protocol+"//"+window.location.host+"/file/"+i.user_id+"/"+e+"/"+encodeURIComponent(t.replace("."+n,""))+"."+n,r.prev=1,r.next=4,i.$copyText(o);case 4:i.$message({message:"链接已成功复制到剪贴板",type:"success"}),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(1),i.$message.error("复制失败");case 10:case"end":return r.stop()}},a,i,[[1,7]])}))()},doPriview:function(e){var t=this;return o()(r.a.mark(function n(){var i;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:"video"==e.category?(t.title=e.name,t.file_id=e.file_id,t.thumbnail=e.thumbnail,t.centerDialogVisible=!0):"image"==e.category?window.open(e.url):(i=window.location.protocol+"//"+window.location.host+"/file/"+t.user_id+"/"+e.file_id+"/"+encodeURIComponent(e.name.replace("."+e.file_extension,""))+"."+e.file_extension,window.open(i));case 1:case"end":return n.stop()}},n,t)}))()},doShare:function(e){var t=this;return o()(r.a.mark(function n(){var i;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.user_id=t.user_id,n.next=3,t.$http.put("/share/list",e);case 3:i=n.sent,t.$message({message:i,type:"success"});case 5:case"end":return n.stop()}},n,t)}))()}}},u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:""}},[n("el-table-column",{attrs:{prop:"name",label:"文件名"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("router-link",{attrs:{to:"/folder/"+e.user_id+"/"+t.row.file_id}},["folder"==t.row.type?n("el-link",{attrs:{type:"primary"}},[e._v(e._s(t.row.name))]):e._e()],1),e._v(" "),"file"==t.row.type?n("el-link",{attrs:{href:"/file/"+e.user_id+"/"+t.row.file_id+"/"+t.row.name,target:"_blank",type:"success"}},[e._v(e._s(t.row.name))]):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"size",label:"类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return["folder"==t.row.type?n("span",[e._v("文件夹")]):n("span",[e._v("文件")])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"size",label:"大小",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return["folder"==t.row.type?n("span",[e._v("————")]):n("span",[e._v(e._s(e._f("initSize")(t.row.size)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"updated_at",label:"更新时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e._f("parseTime")(t.row.updated_at))+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"updated_at",label:"操作",width:"320"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[n("div",{staticStyle:{"margin-bottom":"16px"}},["file"==t.row.type?n("el-button",{attrs:{size:"mini",round:"",type:"primary"},on:{click:function(n){return e.getOneLink(t.row.file_id,t.row.name,t.row.file_extension)}}},[e._v("获取文件直链")]):e._e(),e._v(" "),"file"!=t.row.type?n("el-button",{attrs:{size:"mini",round:"",type:"success"},on:{click:function(n){return e.doShare(t.row)}}},[e._v("分享文件夹")]):e._e(),e._v(" "),"file"==t.row.type?n("el-button",{attrs:{size:"mini",round:"",type:"danger"},on:{click:function(n){return e.doPriview(t.row)}}},[e._v("预览")]):e._e()],1),e._v(" "),"file"!=t.row.type?n("div",[n("el-button",{attrs:{size:"mini",round:"",type:"warning"},on:{click:function(n){return e.getAllLink(t.row.file_id)}}},[e._v("获取全部文件直链")])],1):e._e()])]}}])})],1),e._v(" "),n("el-dialog",{attrs:{title:e.title,"destroy-on-close":!0,visible:e.centerDialogVisible,width:"60%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[n("v-play",{key:e.file_id,attrs:{file_id:e.file_id,user_id:e.user_id,thumbnail:e.thumbnail}})],1)],1)},staticRenderFns:[]};var c=n("VU/8")(l,u,!1,function(e){n("Y2Ra")},null,null);t.a=c.exports}});