webpackJsonp([5],{Eg0l:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("Xxa5"),i=s.n(a),n=s("exGp"),r=s.n(n),o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"map"},["folder"==t.kind?s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbweibiaoti5"}})]):t._e(),t._v(" "),"others"==t.category?s("span",["exe"==t.ext?s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbexe"}})]):t._e(),t._v(" "),"apk"==t.ext?s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbanzhuo"}})]):t._e(),t._v(" "),-1==["apk","exe"].indexOf(t.ext)?s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbf-unknow"}})]):t._e()]):t._e(),t._v(" "),"doc"==t.category?s("span",["txt"==t.ext?s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbtxt"}})]):t._e(),t._v(" "),"doc"==t.ext||"docx"==t.ext?s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbword"}})]):t._e(),t._v(" "),"xls"==t.ext||"xlsx"==t.ext?s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbexcel"}})]):t._e(),t._v(" "),"js"==t.ext?s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbjs"}})]):t._e(),t._v(" "),"css"==t.ext?s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbCSS"}})]):t._e(),t._v(" "),"key"==t.ext?s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbkeynote"}})]):t._e(),t._v(" "),-1==["txt","doc","docx","xls","xlsx","js","css","key"].indexOf(t.ext)?s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbf-unknow"}})]):t._e()]):t._e(),t._v(" "),"image"==t.category?s("span",[s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbimage"}})])]):t._e(),t._v(" "),"zip"==t.category?s("span",[s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbyasuobao"}})])]):t._e(),t._v(" "),"video"==t.category?s("span",[s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbvideo"}})])]):t._e(),t._v(" "),"audio"==t.category?s("span",[s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbaudio"}})])]):t._e()])},staticRenderFns:[]};var d=s("VU/8")({props:["kind","category","ext"]},o,!1,function(t){s("pIWK")},"data-v-1b2e94d1",null).exports,l=s("kzMD"),c=s("o8EA"),u={data:function(){return{faId:null,url:null,show:!1,password:null,refreshing:!1,loading:!1,finished:!1,file_id:null,user_id:null,parent_file_id:null,now:{},box:{name:"",item:[]},errMsg:null}},components:{vPlay:l.a,vIcon:d},filters:{parseTime:function(t){return Object(c.a)(new Date(t))},initSize:function(t){if(!t)return null;var e=t/1024;return(e=e.toFixed(2))>=1024?(e=(e/=1024).toFixed(2))>=1024?(e=(e/=1024).toFixed(2))>=1024?(e=(e/=1024).toFixed(2),e+="TB"):e+="GB":e+="MB":e+="KB",e}},computed:{id:function(){return this.$route.params.id},isMb:function(){return!!navigator.userAgent.match(/(iPhone|iPod|Android|ios|iOS|iPad|Backerry|WebOS|Symbian|Windows Phone|Phone)/i)}},mounted:function(){this.onRefresh()},methods:{onLoad:function(){var t=this;return r()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:case"end":return e.stop()}},e,t)}))()},openFile:function(t){var e=this;return r()(i.a.mark(function s(){return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:console.log(t),"file"!=t.type?(e.file_id=t.file_id,e.onRefresh()):(e.now=t,e.url="/file/"+e.user_id+"/"+t.file_id+"/"+t.name,"video"==t.category||"image"==t.category?e.show=!0:window.open(e.url));case 2:case"end":return s.stop()}},s,e)}))()},doDownload:function(){var t=this;return r()(i.a.mark(function e(){var s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("/share/downLoad",{params:{id:t.id,password:t.password,file_id:t.now.file_id,file_name:t.now.file_name},headers:{loadingNo:!0}});case 2:s=e.sent,window.open(s.url);case 4:case"end":return e.stop()}},e,t)}))()},doBack:function(){this.file_id=this.parent_file_id,this.parent_file_id=null,this.box={name:"",item:[]},this.onRefresh()},onRefresh:function(){this.finished=!1,this.loading=!0,this.onLoad()},init:function(){var t=this;return r()(i.a.mark(function e(){var s,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.refreshing&&(t.box={name:"",item:[]},t.refreshing=!1,t.finished=!1),s=void 0,t.isMb||(s=t.$loading("加载中...")),e.prev=3,e.next=6,t.$http.get("/share/public",{params:{id:t.id,password:t.password,file_id:t.file_id},headers:{loadingNo:!0}});case 6:a=e.sent,t.isMb||s.close(),t.box=a,t.user_id=a.user_id,t.file_id=a.file_id,t.parent_file_id=a.parent_file_id,a.faId&&(t.faId=a.faId),console.log(a),document.title=t.box.name,t.errMsg=null,e.next=26;break;case 18:e.prev=18,e.t0=e.catch(3),console.log(e.t0),t.isMb||s.close(),t.box.name=e.t0.name,t.errMsg=e.t0.errMsg,document.title=e.t0.name,t.isMb?"请输入密码"!=t.errMsg&&t.$toast(t.errMsg):"请输入密码"!=t.errMsg&&t.$message.error(t.errMsg);case 26:return t.loading=!1,t.finished=!0,e.abrupt("return",!0);case 29:case"end":return e.stop()}},e,t,[[3,18]])}))()}}},f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.id?s("section",{staticClass:"op"},[t.parent_file_id&&t.faId==t.parent_file_id&&!t.errMsg?s("div",{staticClass:"back",on:{click:function(e){return t.doBack()}}},[s("svg",{staticClass:"tbfont",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#tbyk_fanhui"}})]),t._v(" "),s("span",{staticClass:"txt"},[t._v("返回上级")])]):t._e(),t._v(" "),t.errMsg?s("div",{staticClass:"errMsg"},[s("h2",[t._v(t._s(t.box.name))]),t._v(" "),s("p",{staticClass:"it"},[t._v(t._s(t.errMsg))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),t._v(" "),s("button",{on:{click:function(e){return t.onRefresh()}}},[t._v("立即进入")])]):t._e(),t._v(" "),t.errMsg?t._e():s("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[s("van-list",{attrs:{"immediate-check":!1,finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.box.item,function(e){return s("div",{key:e.file_id,staticClass:"btn",on:{click:function(s){return t.openFile(e)}}},[s("v-icon",{staticClass:"icon",attrs:{kind:e.type,category:e.category,ext:e.file_extension}}),t._v(" "),s("div",{staticClass:"info"},[s("p",{staticClass:"title"},[t._v(t._s(e.name))]),t._v(" "),s("p",{staticClass:"desc"},[s("span",{staticClass:"time"},[t._v(t._s(t._f("parseTime")(e.created_at)))]),t._v(" "),"file"==e.type?s("span",{staticClass:"size"},[t._v(t._s(t._f("initSize")(e.size)))]):t._e()])])],1)}),0)],1),t._v(" "),s("van-overlay",{attrs:{show:t.show}},[s("section",{staticClass:"md"},[t.show&&"video"==t.now.category?s("v-play",{key:t.now.file_id,attrs:{file_id:t.now.file_id,user_id:t.user_id,thumbnail:t.now.thumbnail}}):t._e(),t._v(" "),t.show&&"image"==t.now.category?s("img",{staticClass:"xi",attrs:{src:t.url,alt:""}}):t._e(),t._v(" "),s("div",{staticClass:"rf"},[s("span",{staticClass:"el-icon-download",on:{click:function(e){return t.doDownload()}}}),t._v(" "),s("span",{staticClass:"el-icon-close",on:{click:function(e){t.show=!1}}})])],1)])],1):t._e()},staticRenderFns:[]};var _=s("VU/8")(u,f,!1,function(t){s("wVRg")},"data-v-5a5d8af4",null);e.default=_.exports},pIWK:function(t,e){},wVRg:function(t,e){}});